<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DAVE-Chatbot AvancÃ© ğŸ¤–</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body { font-family: Arial, sans-serif; background:#f2f2f2; margin:0; }
  header { background:#4A90E2; color:#fff; padding:10px; display:flex; justify-content:space-between; align-items:center; }
  header h1 { margin:0; font-size:20px; }
  #menu-btn { font-size:24px; cursor:pointer; }
  #menu { display:none; position:absolute; top:50px; right:10px; background:#fff; border-radius:20px; padding:10px; box-shadow:0 2px 5px rgba(0,0,0,0.2); }
  #menu a { display:block; padding:26px 15px; text-decoration:none; color:#333; }
  #chat-container { display:flex; flex-direction:column; height:calc(100vh - 50px); }
  #messages { flex:1; overflow-y:auto; padding:10px; }
  .message { display:flex; align-items:flex-start; margin:10px 0; }
  .message img { width:40px; height:40px; border-radius:50%; margin-right:10px; }
  .message-content { max-width:70%; background:#fff; padding:10px; border-radius:10px; box-shadow:0 1px 3px rgba(0,0,0,0.2); }
  .user { flex-direction:row-reverse; }
  .user .message-content { background:#DCF8C6; }
  #input-container { display:flex; padding:10px; background:#eee; }
  #input-container input[type=text] { flex:1; padding:10px; border-radius:20px; border:none; outline:none; }
  #input-container button { margin-left:5px; border:none; background:#4A90E2; color:#fff; padding:10px 15px; border-radius:50%; cursor:pointer; }
  #emoji-picker { position:absolute; bottom:60px; left:10px; display:none; background:#fff; border:1px solid #ccc; border-radius:5px; padding:5px; max-width:300px; max-height:200px; overflow:auto; }
  #emoji-picker span { cursor:pointer; font-size:20px; margin:3px; }
</style>
</head>
<body>

<header>
  <h1>Dave-Chatbot ğŸ¤–</h1>
  <i class="fa fa-bars" id="menu-btn"></i>
</header>

<div id="menu">
  <a href="tuto.html" target="_blank">Tutoriel</a>
  <a href="assistant.html" target="_blank">Assistant</a>
  <a href="politique.html" target="_blank">Politique</a>
  <a href="apple.html" target="_blank">Apple Card</a>
  <a href="exchange.html" target="_blank">Exchange</a>
  <a href="wallet.html" target="_blank">Mon portefeuille</a>
</div>

<div id="chat-container">
  <div id="messages"></div>
  <div id="input-container">
    <button id="emoji-btn">ğŸ˜Š</button>
    <input type="text" id="user-input" placeholder="Tapez un message...">
    <button id="send-btn"><i class="fa fa-paper-plane"></i></button>
    <button id="voice-btn"><i class="fa fa-microphone"></i></button>
    <input type="file" id="upload-photo" style="display:none;">
    <button id="upload-btn"><i class="fa fa-image"></i></button>
  </div>
  <div id="emoji-picker">
    <span>ğŸ˜€</span><span>ğŸ˜‚</span><span>ğŸ˜</span><span>ğŸ˜</span><span>ğŸ¤”</span>
    <span>ğŸ‘</span><span>ğŸ™</span><span>ğŸ’–</span><span>ğŸ”¥</span><span>ğŸ¥³</span>
  </div>
</div>

<script>
const menuBtn = document.getElementById('menu-btn');
const menu = document.getElementById('menu');
menuBtn.addEventListener('click', () => { menu.style.display = menu.style.display === 'block' ? 'none' : 'block'; });

const emojiBtn = document.getElementById('emoji-btn');
const emojiPicker = document.getElementById('emoji-picker');
const userInput = document.getElementById('user-input');
emojiBtn.addEventListener('click', () => { emojiPicker.style.display = emojiPicker.style.display === 'block' ? 'none' : 'block'; });
emojiPicker.querySelectorAll('span').forEach(emoji => {
  emoji.addEventListener('click', () => { userInput.value += emoji.textContent; });
});

const messages = document.getElementById('messages');
let userPhoto = 'user.png'; // Mete photo ou la
let botPhoto = 'https://files.catbox.moe/ahb736.png'; // Mete photo bot ou la

function addMessage(text, sender='user', photo=null) {
  const msg = document.createElement('div');
  msg.classList.add('message', sender);
  const img = document.createElement('img');
  img.src = photo || (sender==='user' ? userPhoto : botPhoto);
  const content = document.createElement('div');
  content.classList.add('message-content');
  content.textContent = text;
  msg.appendChild(img);
  msg.appendChild(content);
  messages.appendChild(msg);
  messages.scrollTop = messages.scrollHeight;
}

document.getElementById('send-btn').addEventListener('click', () => {
  const text = userInput.value.trim();
  if(text) {
    addMessage(text, 'user', userPhoto);
    userInput.value = '';
    sendToGemini(text);
  }
});

const uploadBtn = document.getElementById('upload-btn');
const uploadInput = document.getElementById('upload-photo');
uploadBtn.addEventListener('click', () => uploadInput.click());
uploadInput.addEventListener('change', () => {
  const file = uploadInput.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = e => { addMessage('ğŸ“· Photo envoyÃ©e', 'user', e.target.result); };
    reader.readAsDataURL(file);
  }
});

const voiceBtn = document.getElementById('voice-btn');
let recognition;
if('webkitSpeechRecognition' in window){
  recognition = new webkitSpeechRecognition();
  recognition.lang = 'fr-FR';
  recognition.continuous = false;
  recognition.interimResults = false;
  recognition.onresult = e => {
    const transcript = e.results[0][0].transcript;
    addMessage(transcript, 'user', userPhoto);
    sendToGemini(transcript);
  }
}
voiceBtn.addEventListener('click', () => { if(recognition) recognition.start(); });

// Gemini AI integration
async function sendToGemini(prompt){
  addMessage("ğŸ¤– ... en train de rÃ©flÃ©chir", 'bot', botPhoto);
  try{
    const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent", {
      method:'POST',
      headers:{
        'Content-Type':'application/json',
        'Authorization':'AIzaSyB7URXCSpZtdCdKCjBGkvV27nLURDDn1FM'
      },
      body: JSON.stringify({prompt})
    });
    const data = await response.json();
    addMessage(data.reply || "ğŸ¤– Je n'ai pas de rÃ©ponse pour le moment", 'bot', botPhoto);
  }catch(e){
    addMessage("âš ï¸ Erreur Gemini API", 'bot', botPhoto);
    console.error(e);
  }
}
window.onload = () => {
    addMessage("Halo! Saya DAWENS AI Assistant yang menggunakan Gemini 2.5 Flash. Silakan tanyakan apa saja kepada saya! Saya siap membantu Anda dengan berbagai pertanyaan.", 'bot', botPhoto);
};
</script>
</body>
</html