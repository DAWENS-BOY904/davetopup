<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallet Da-TopUp</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f2f2f2;color:#333;}
header{background:#4caf50;color:#fff;padding:15px;text-align:center;}
header h1{margin:0;font-size:24px;}
.container{padding:20px;max-width:1200px;margin:auto;}
.card{background:#fff;padding:15px;margin-bottom:20px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
h2{color:#4caf50;margin-bottom:10px;}
input,select{padding:10px;width:100%;margin:5px 0;border-radius:6px;border:1px solid #ccc;}
button{padding:10px 15px;border:none;background:#4caf50;color:#fff;border-radius:6px;cursor:pointer;margin:5px 0;}
button:hover{background:#388e3c;}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);justify-content:center;align-items:center;}
.modal-content{background:#fff;padding:20px;width:400px;border-radius:8px;position:relative;max-height:80vh;overflow-y:auto;}
.modal-content i{position:absolute;top:10px;right:10px;cursor:pointer;color:red;}
.table{width:100%;border-collapse:collapse;margin-top:10px;}
.table th,.table td{border:1px solid #ccc;padding:8px;text-align:left;}
.balance{display:flex;gap:20px;margin-bottom:15px;}
.balance div{background:#e8f5e9;padding:15px;border-radius:8px;flex:1;text-align:center;font-size:18px;}
.balance div span{display:block;font-size:24px;font-weight:bold;color:#4caf50;}
</style>
</head>
<body>

<header>
  <h1>Wallet DaveTopUp</h1>
</header>

<div class="container">

  <!-- Balance display -->
  <div class="balance">
    <div>Balance USD <span id="balanceUSD">0.00</span></div>
    <div>Balance HTG <span id="balanceHTG">0</span></div>
  </div>

  <!-- Wallet TopUp -->
  <div class="card">
    <h2>Wallet TopUp <i class="fa-solid fa-plus" style="cursor:pointer;" onclick="openTopUpModal()"></i></h2>
    <input type="number" id="topupAmount" placeholder="Enter Amount">
    <button onclick="addTopUp()">Add</button>
  </div>

  <!-- Wallet Transfer -->
  <div class="card">
    <h2>Wallet Transfer <i class="fa-solid fa-arrow-right" style="cursor:pointer;"></i></h2>
    <input type="email" id="transferEmail" placeholder="Enter recipient Gmail">
    <input type="number" id="transferAmount" placeholder="Enter Amount">
    <input type="text" id="transferPurpose" placeholder="Purpose / What this is for">
    <button onclick="transferWallet()">Transfer</button>
  </div>

  <!-- Transactions -->
  <div class="card">
    <h2>Transactions <i class="fa-solid fa-list" style="cursor:pointer;"></i></h2>
    <table class="table" id="transactionTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Type</th>
          <th>Amount</th>
          <th>Details</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>

</div>

<!-- TopUp Modal -->
<div class="modal" id="topUpModal">
  <div class="modal-content">
    <i class="fa-solid fa-xmark" onclick="closeTopUpModal()"></i>
    <h3>TopUp Wallet</h3>
    <input type="number" id="modalAmount" placeholder="Enter Amount">
    <button onclick="confirmTopUp()">Confirm & Go to Checkout</button>
  </div>
</div>

<script>
// --- Modal functions ---
function openTopUpModal(){ document.getElementById("topUpModal").style.display="flex"; }
function closeTopUpModal(){ document.getElementById("topUpModal").style.display="none"; }

// --- Balance & transactions ---
let balanceUSD = 0;
let balanceHTG = 0;
let transactions = [];

function updateBalance(){
  document.getElementById("balanceUSD").textContent = balanceUSD.toFixed(2);
  document.getElementById("balanceHTG").textContent = (balanceUSD*132).toFixed(0);
}

// --- TopUp functions ---
function addTopUp(){
  const amt = parseFloat(document.getElementById("topupAmount").value);
  if(isNaN(amt) || amt<=0){ alert("Enter a valid amount"); return; }
  // add to transactions
  const id = Date.now();
  transactions.push({id:id,type:"TopUp",amount:amt,details:"Wallet TopUp",date:new Date().toLocaleString()});
  balanceUSD += amt;
  updateBalance();
  renderTransactions();
  alert("Added to wallet. You can proceed to checkout.");
}

function confirmTopUp(){
  const amt = parseFloat(document.getElementById("modalAmount").value);
  if(isNaN(amt) || amt<=0){ alert("Enter a valid amount"); return; }
  const id = Date.now();
  transactions.push({id:id,type:"TopUp",amount:amt,details:"Wallet TopUp via Modal",date:new Date().toLocaleString()});
  balanceUSD += amt;
  updateBalance();
  renderTransactions();
  closeTopUpModal();
  // redirect to checkout.html
  window.location.href="checkout.html";
}

// --- Transfer functions ---
function transferWallet(){
  const email = document.getElementById("transferEmail").value.trim();
  const amt = parseFloat(document.getElementById("transferAmount").value);
  const purpose = document.getElementById("transferPurpose").value.trim();
  if(!email || isNaN(amt) || amt<=0){ alert("Enter valid info"); return; }
  if(amt>balanceUSD){ alert("Insufficient balance"); return; }
  balanceUSD -= amt;
  transactions.push({id:Date.now(),type:"Transfer",amount:amt,details:`To: ${email} | Purpose: ${purpose}`,date:new Date().toLocaleString()});
  updateBalance();
  renderTransactions();
  alert("Wallet transfer completed!");
}

// --- Render transactions ---
function renderTransactions(){
  const tbody = document.getElementById("transactionTable").querySelector("tbody");
  tbody.innerHTML="";
  transactions.forEach(t=>{
    const tr = document.createElement("tr");
    tr.innerHTML=`<td>${t.id}</td><td>${t.type}</td><td>$${t.amount.toFixed(2)}</td><td>${t.details}</td><td>${t.date}</td>`;
    tbody.appendChild(tr);
  });
}

// Initialize
updateBalance();
</script>

</body>
</html>